
<!-- saved from url=(0077)http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=05.%20Server%20fisiere -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 



<title>Sisteme de Operare</title>
    
    <meta http-equiv="description" content="Sisteme de Operare">
    <meta http-equiv="distribution" content="\&quot;Global\&quot;">
    <link rel="stylesheet" href="./Sisteme de Operare_files/base.css" type="text/css">
    <link rel="stylesheet" href="./Sisteme de Operare_files/vmchecker.css" type="text/css">
</head>

      
<body><table width="70%" border="0" cellspacing="0" cellpadding="5" align="center">
    <tbody><tr><td align="center" bgcolor="#ffce3d" class="fontmaroon">
	Sisteme de Operare    </td></tr>
    <tr><td align="center" bgcolor="#ffea9c" class="fontred">
	Teme&nbsp;
    </td></tr>
</tbody></table>

<table width="100%" border="0" cellspacing="0" cellpadding="0"><tbody><tr><td align="center"><br>
<table width="96%" border="0" cellspacing="0" cellpadding="0">

    <tbody><tr>
	<td width="16%" valign="top">
	    
	<br>
	<table width="100%" border="0" cellspacing="4" cellpadding="5">
    	<tbody><tr><td bgcolor="#ffce3d" align="center"> 
	
        <a href="http://elf.cs.pub.ro/so/cs/index.php" class="linkmaroon">Home</a>
	
	</td></tr>
        <tr><td bgcolor="#5bb7d3" align="center"> 
	<br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Examen" class="linkwhite">Examen </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Cursuri" class="linkwhite">Cursuri </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Laboratoare" class="linkwhite">Laboratoare </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Arhive%20discu%C8%9Bii" class="linkwhite">Arhive discuții </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=SearchNew" class="linkwhite">SearchNew </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme" class="linkwhite">Teme </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Search" class="linkwhite">Search </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Reguli%20si%20notare" class="linkwhite">Reguli si notare </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Evaluare" class="linkwhite">Evaluare </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Anunturi" class="linkwhite">Anunturi </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Login" class="linkwhite">Login </a><br>
	<br></td></tr>
	<tr><td bgcolor="white">&nbsp;<br><br></td></tr>
	</tbody></table>
		</td>
	<td width="1%">
	    &nbsp;
	</td>
	<td width="62%" valign="top" bgcolor="#f7f3e6">
	    <table width="100%" border="0" cellspacing="0" cellpadding="10">
	    <tbody><tr><td>
    	        <p align="right"><a href="http://elf.cs.pub.ro/so/cs/wiki/index.php?title=Teme:Server%20fisiere">WIKI</a> | <a href="http://elf.cs.pub.ro/so/cs/Teme/05.%20Server%20fisiere.pdf">PDF</a></p><h1 align="center">Server fisiere</h1>			<p align="center">Termen de predare: Joi, 4 iunie 2009, ora 23:59 (2009-06-04)</p>
<table id="toc" class="toc" summary="Contents"><tbody><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=05.%20Server%20fisiere#Enun.C8.9B"><span class="tocnumber">1</span> <span class="toctext">Enunț</span></a></li>
<li class="toclevel-1"><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=05.%20Server%20fisiere#Preciz.C4.83ri_generale"><span class="tocnumber">2</span> <span class="toctext">Precizări generale</span></a></li>
<li class="toclevel-1"><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=05.%20Server%20fisiere#Testare"><span class="tocnumber">3</span> <span class="toctext">Testare</span></a></li>
<li class="toclevel-1"><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=05.%20Server%20fisiere#Preciz.C4.83ri_Windows"><span class="tocnumber">4</span> <span class="toctext">Precizări Windows</span></a></li>
<li class="toclevel-1"><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=05.%20Server%20fisiere#Precizari_Linux"><span class="tocnumber">5</span> <span class="toctext">Precizari Linux</span></a></li>
<li class="toclevel-1"><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=05.%20Server%20fisiere#FAQ"><span class="tocnumber">6</span> <span class="toctext">FAQ</span></a></li>
<li class="toclevel-1"><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=05.%20Server%20fisiere#.C3.8Entreb.C4.83ri"><span class="tocnumber">7</span> <span class="toctext">Întrebări</span></a></li>
</ul>
</td></tr></tbody></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Enun.C8.9B" id="Enun.C8.9B"></a><h2> <span class="mw-headline">Enunț</span></h2>
<p>Să se implementeze un server de fișiere ce va folosi portul TCP 8192 pentru a răspunde la cereri din rețea. Serverul trebuie să ofere următoarele funcții clienților: listarea fișierelor dintr-un director, citirea dintr-un fișier, scrierea într-un fișier.
</p><p>Toate operațiile se vor face asincron folosind mecanismele cele mai scalabile oferite de fiecare sistem de operare.
</p><p>Se va implementa de asemenea și un client, cu următoarea comportare:
</p>
<ul><li> Sintaxa:
</li></ul>
<div dir="ltr" style="text-align: left;"><div class="source-bash" style="font-family: monospace;"><pre>client adresa_server rd fisier offset len
client adresa_server wr fisier offset len</pre></div></div>
<p>Acțiune: citirea, respectiv scrierea în fișierul <tt>fisier</tt> <tt>len</tt> octeți începând de la poziția <tt>offset</tt>. Datele se vor citi de la <tt>STDIN</tt> și se vor scrie la <tt>STDOUT</tt>.
</p>
<ul><li> şi
</li></ul>
<div dir="ltr" style="text-align: left;"><div class="source-bash" style="font-family: monospace;"><pre>client adresa_server <span class="kw2">ls</span> director</pre></div></div> 
<p>Acțiune: listarea fișierelor din directorul <tt>director</tt> la <tt>STDOUT</tt>. Pentru a ușura testarea, am ales să impunem un format simplu pentru listing:  un fişier/director pe fiecare linie precedat de mărimea lui. Directoarele vor fi urmate de caracterul '/'. Mărimea directoarelor este cea întoarsă de <tt>ls</tt> (0 pe Windows, un multiplu de block size pe Linux).
</p>
<a name="Preciz.C4.83ri_generale" id="Preciz.C4.83ri_generale"></a><h2> <span class="mw-headline">Precizări generale</span></h2>
<p>Ordinea parametrilor trebuie respectată, întrucât testele fac anumite presupuneri asupra lor.
</p><p>Serverul trebuie să asculte eventualele cereri pe adresa 127.0.0.1
</p><p>Clientul va afișa la stdout numai ceea ce primește de la server.
</p><p>În cazul în care apar erori la server, acestea vor fi trimise clientului care va ieși cu un cod de ieșire&nbsp;!= 0.
</p><p>De asemenea, dacă clientul primește parametri necorespunzători, trebuie sa iasă cu cod de ieșire&nbsp;!= 0.
</p><p><font color="red">FIXME: Pentru a evita un race în testare, este nevoie sa aşteptaţi în client terminarea operaţiei de scriere în server înainte de a ieşi. Altfel, s-ar putea ca testul să compare fişierul output cu cel corect înainte să termine serverul de scris.</font>
</p><p>Exemple de funcţionare client:
</p>
<div dir="ltr" style="text-align: left;"><div class="source-bash" style="font-family: monospace;"><pre><span class="br0">[</span>tema5<span class="br0">]</span>$ .<span class="sy0">/</span>client <span class="nu0">127.0</span><span class="nu0">.0</span><span class="nu0">.1</span> <span class="kw2">ls</span> testdir <span class="nu0">2</span><span class="sy0">&gt;</span> <span class="sy0">/</span>dev<span class="sy0">/</span>null
          <span class="nu0">0</span> dir1<span class="sy0">/</span>
         <span class="nu0">24</span> testfile1
         <span class="nu0">12</span> x.txt
<span class="br0">[</span>tema5<span class="br0">]</span>$ .<span class="sy0">/</span>client <span class="nu0">127.0</span><span class="nu0">.0</span><span class="nu0">.1</span> rd testdir<span class="sy0">/</span>testfile1 <span class="nu0">0</span> <span class="nu0">100</span> <span class="nu0">2</span><span class="sy0">&gt;</span> <span class="sy0">/</span>dev<span class="sy0">/</span>null
<span class="nu0">1234567890</span>
abcdefghij
<span class="br0">[</span>tema5<span class="br0">]</span>$ .<span class="sy0">/</span>client <span class="nu0">127.0</span><span class="nu0">.0</span><span class="nu0">.1</span> wr testdir<span class="sy0">/</span>testfile1 <span class="nu0">4</span> <span class="nu0">6</span> <span class="nu0">2</span><span class="sy0">&gt;</span> <span class="sy0">/</span>dev<span class="sy0">/</span>null
abcdef
<span class="br0">[</span>tema5<span class="br0">]</span>$ <span class="kw2">cat</span> testdir<span class="sy0">/</span>testfile1
1234abcdef
abcdefghij
<span class="br0">[</span>tema5<span class="br0">]</span>$</pre></div></div>
<a name="Testare" id="Testare"></a><h2> <span class="mw-headline">Testare</span></h2>
<p>Pentru simplificarea procesului de corectare a temelor, dar şi pentru a reduce greşelile temelor trimise, corectarea temelor se va face automat cu ajutorul unor teste publice. (<a href="http://cs.pub.ro/~so/Teme/5-asyncio-lin.zip" class="external text" title="http://cs.pub.ro/~so/Teme/5-asyncio-lin.zip" rel="nofollow">linux</a>, <a href="http://cs.pub.ro/~so/Teme/5-asyncio-win.zip" class="external text" title="http://cs.pub.ro/~so/Teme/5-asyncio-win.zip" rel="nofollow">windows</a>).
</p><p>Formatul afişării, aşa cum a fost descris mai sus, este obligatoriu.
</p><p>În urma compilării temei trebuie să rezulte două executabile: <tt>server</tt> (respectiv <tt>server.exe</tt> pentru Windows) şi <tt>client</tt> (respectiv <tt>client.exe</tt> pentru Windows). Numele acestor executabile trebuie să fie respectat.
</p><p>Se vor acorda 0.4p pentru fiecare test. Nota rezultată poate fi modificată prin depunctări suplimentare:
</p>
<ul><li> -0.1 pentru README necorespunzator
</li><li> -0.1 pentru surse prost comentate
</li><li> -0.2 pentru ilizibilitatea codului
</li><li> -0.2 neverificarea conditiilor de eroare/memory leak-uri/etc
</li><li> -0.4 implementare incorectă(protocol incorect, race-uri, potenţiale erori de memorie)
</li></ul>
<a name="Preciz.C4.83ri_Windows" id="Preciz.C4.83ri_Windows"></a><h2> <span class="mw-headline">Precizări Windows</span></h2>
<p>Se vor folosi funcţii asincrone de citire/scriere pe sockeţi/fişiere împreună cu mecanismul de completion ports pentru primirea notificarilor. Pool-ul de threaduri va fi egal cu numarul de procesoare din sistem. Numărul de procesoare se află cu ajutorul funcţiei GetSystemInfo. Pentru listarea conţinutului unui director se pot folosi funcţiile FindFirstFile/FindNextFile.
</p><p>Tema se va rezolva folosind doar funcţii Win32. Se pot folosi de asemenea şi funcţiile de formatare <tt>printf, scanf</tt>, funcţiile de alocare de memorie <tt> malloc, free</tt> si funcţiile de manipulare a şirurilor de caractere (<tt>strcat</tt>, <tt>strdup</tt>, etc.)
</p><p>Pentru partea de I/O şi procese se vor folosi doar funcţii Win32. De exemplu, funcţiile <tt>open</tt>, <tt>read</tt>, <tt>write</tt>, <tt>close</tt> nu trebuie folosite, în locul acestor trebuind să folosiţi <tt>CreateFile</tt>, <tt>ReadFile</tt>, <tt>WriteFile</tt>, <tt>CloseHandle</tt>.
</p>
<a name="Precizari_Linux" id="Precizari_Linux"></a><h2> <span class="mw-headline">Precizari Linux</span></h2>
<p>Pe Linux, se va aştepta unificat încheierea unei operaţii asincrone şi trimiterea/recepţionarea  datelor pe sockeţi. Serverul va multiplexa clienţii într-un singur thread folosind epoll şi se va folosi de KAIO pentru citire/scriere din fişiere. Notificarea terminării operaţiilor asincrone se va face
folosind eventfd. Pentru listarea continutului unui director se pot folosi funcţiile din dirent.h, opendir/readdir. Pentru aflarea marimii unui director se poate folosi funcţia stat.
</p><p>Tema se va rezolva folosind doar functii POSIX. Se pot folosi de asemenea şi funcţiile de formatare <tt>printf, scanf</tt>, funcţiile de alocare de memorie <tt> malloc, free</tt> şi funcţiile de manipulare a şirurilor de caractere (<tt>strcat</tt>, <tt>strdup</tt>, etc.)
</p><p>Pentru partea de I/O si procese se vor folosi doar funcţii POSIX. De exemplu, funcţiile <tt>fopen</tt>, <tt>fread</tt>, <tt>fwrite</tt>, <tt>fclose</tt> nu trebuie folosite, în locul acestora trebuind să folosiţi <tt>open</tt>, <tt>read</tt>, <tt>write</tt>, <tt>close</tt>.
</p>
<a name="FAQ" id="FAQ"></a><h2> <span class="mw-headline">FAQ</span></h2>
<ul><li> <b>Q:</b> In server, toate operatiile se vor face asincron folosind mecanismele cele mai scalabile oferite de fiecare sistem de operare. Asta inseamna si socketi nonblocanti sau se refera doar la partea de IO?
</li></ul>
<dl><dd> <b>A:</b> Da, folositi socketi neblocanti. Cu socketii blocanti exista riscul blocarii in anumite operatii, cum ar fi write daca bufferul asociat socketului este plin.
</dd></dl>
<ul><li> <b>Q:</b> În cazul în care clientul dă o comanda wr/rd trebuie să trimită/citescă date pe/de pe socket. Trebuie să le trimită/citească cu io asincron?
</li></ul>
<dl><dd> <b>A:</b> Pe partea de client nu are nici un sens să folosiţi altceva decat read/write blocant.
</dd></dl>
<ul><li> <b>Q:</b> Ce se intampla atunci cand se incearca scrierea intr-un fisier care nu exista. Se creeaza fisierul sau se intoarce eroare la client?
</li></ul>
<dl><dd> <b>A:</b> Se crează.
</dd></dl>
<a name=".C3.8Entreb.C4.83ri" id=".C3.8Entreb.C4.83ri"></a><h2> <span class="mw-headline">Întrebări</span></h2>
<p>Pentru lamuriri suplimentare asupra temei consultati <a href="http://cursuri.cs.pub.ro/pipermail/so" class="external text" title="http://cursuri.cs.pub.ro/pipermail/so" rel="nofollow">arhivele</a> listei de discutii sau dati un <a href="mailto:so@cursuri.cs.pub.ro" class="external text" title="mailto:so@cursuri.cs.pub.ro" rel="nofollow">mail</a> (trebuie sa fiti <a href="http://cursuri.cs.pub.ro/liste/so" class="external text" title="http://cursuri.cs.pub.ro/liste/so" rel="nofollow">inregistrati</a> ).
</p>
<!-- 
NewPP limit report
Preprocessor node count: 55/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key sowiki14:pcache:idhash:43-0!1!0!!en!2!edit=0 and timestamp 20090527053401 -->
	    </td></tr>
	    </tbody></table>
	</td>
	<td width="1%">
	    &nbsp;
	</td>
	<td width="16%" valign="top">
	    <br>
	    
	<br>
	<table width="100%" border="0" cellspacing="4" cellpadding="5">
    	<tbody><tr><td bgcolor="#ffce3d" align="center"> 
	
        <a href="http://elf.cs.pub.ro/so/cs/index.php" class="linkmaroon">Teme</a>
	
	</td></tr>
        <tr><td bgcolor="#5bb7d3" align="center"> 
	<br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=01.%20Mini-shell" class="linkwhite">01. Mini-shell </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=02.%20Mecanisme%20IPC" class="linkwhite">02. Mecanisme IPC </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=02.%20Utilizare%20IPC" class="linkwhite">02. Utilizare IPC </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=03.%20Memorie%20virtuala" class="linkwhite">03. Memorie virtuala </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=04.%20Monitor%20generic" class="linkwhite">04. Monitor generic </a><br><br><a href="./Sisteme de Operare_files/Sisteme de Operare.html" class="linkwhite">05. Server fisiere </a><br><br><a href="http://elf.cs.pub.ro/so/cs/index.php?section=Teme&file=Reguli" class="linkwhite">Reguli </a><br>
	<br></td></tr>
	<tr><td bgcolor="white">&nbsp;<br><br></td></tr>
	</tbody></table>
		</td>
    </tr>
    <tr>
	<td></td>
    </tr>

</tbody></table>
<br><br></td></tr></tbody></table>
</body></html>